find_package(Doxygen REQUIRED dot)

set(DOXYGEN_PROJECT_NAME variant-cpp11)

# range of documentation
set(DOXYGEN_EXTRACT_ALL NO)
set(DOXYGEN_EXTRACT_PRIVATE YES)
set(DOXYGEN_EXTRACT_PRIV_VIRTUAL)
set(DOXYGEN_EXTRACT_STATIC YES)

# inputs
set(DOXYGEN_RECURSIVE YES)
set(DOXYGEN_FILE_PATTERNS *.h *.md)
set(DOXYGEN_INPUT_ENCODING UTF-8)
set(DOXYGEN_USE_MDFILE_AS_MAINPAGE README.md)

# warnings
set(DOXYGEN_QUIET YES)
set(DOXYGEN_WARNINGS YES)
set(DOXYGEN_WARN_IF_UNDOCUMENTED YES)
set(DOXYGEN_WARN_NO_PARAMDOC YES)

# source browsing
set(DOXYGEN_SOURCE_BROWSER YES)

# for class documentations
set(DOXYGEN_BUILTIN_STL_SUPPORT YES)
set(DOXYGEN_SORT_BRIEF_DOCS YES)
set(DOXYGEN_SORT_MEMBER_DOCS YES)

# for diagrams automatically generated with dot
set(DOXYGEN_DOT_IMAGE_FORMAT svg)
set(DOXYGEN_INTERACTIVE_SVG YES)
set(DOXYGEN_DIRECTORY_GRAPH NO)
set(DOXYGEN_TEMPLATE_RELATIONS YES)
set(DOXYGEN_UML_LOOK YES)
set(DOXYGEN_DOT_NUM_THREADS 1)

# for preprocessors
set(DOXYGEN_ENABLE_PREPROCESSING YES)
set(DOXYGEN_MACRO_EXPANSION YES)
set(DOXYGEN_EXPAND_ONLY_PREDEF YES)
# set(DOXYGEN_PREDEFINED)

# for html output
set(DOXYGEN_GENERATE_HTML YES)
set(DOXYGEN_HTML_COLORSTYLE_HUE 24)
set(DOXYGEN_HTML_COLORSTYLE_SAT 255)
set(DOXYGEN_HTML_COLORSTYLE_GAMMA 100)
set(DOXYGEN_HTML_TIMESTAMP YES)
set(DOXYGEN_HTML_DYNAMIC_MENUS YES)
set(DOXYGEN_HTML_DYNAMIC_SECTIONS YES)

# for xml output set(DOXYGEN_GENERATE_XML YES)

# output directory
set(DOXYGEN_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})

doxygen_add_docs(
    variant_cpp11_doc_doxygen "include" "README.md"
    WORKING_DIRECTORY "${VARIANT_CPP11_SOURCE_DIR}"
    ALL
    COMMENT "Generate Doxygen API documentation for ${PROJECT_NAME}")

add_dependencies(variant_cpp11_doc variant_cpp11_doc_doxygen)
